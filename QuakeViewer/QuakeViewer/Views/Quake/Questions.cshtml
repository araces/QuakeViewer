@model QuakeViewer.Models.QuestionModel
@{
    var provinceList = ViewData["Province"] as List<SelectListItem>;
}
<style>
.top-header{
	height:230px;
	}
</style>
		<div class="row">
		<div class="col-sm-12"> <h2 class="text-center"> 所查房屋的基本信息 </h2></div>
	</div>

  	<div class="row">	
	  <div class="col-sm-offset-1 col-sm-11">
	      <div class="divider-header"></div>
	      @using(Html.BeginForm("Questions", "Quake", new { }, FormMethod.Post, new { @class = "form-horizontal", role = "form" }))
        {
        @Html.AntiForgeryToken()
	          <div class="form-group">
	              <label>房屋所在的位置：</label>
	              <div>
	                  <label for="provincial" class="col-sm-1 control-label">省</label>
	                  <div class="col-sm-2">
                          @Html.DropDownListFor(p=>p.Provincial, provinceList,new {@class="form-control"})
	                  </div>
	                  <label for="provincial" class="col-sm-1 control-label">市</label>
	                  <div class="col-sm-2">
                        @Html.DropDownListFor(p => p.City, new List<SelectListItem>(), new { @class = "form-control" })
	                  </div>
	                  <label for="provincial" class="col-sm-1 control-label">区县</label>
	                  <div class="col-sm-2">
                        @Html.DropDownListFor(p => p.Region, new List<SelectListItem>(), new { @class = "form-control" })
	                  </div>
	              </div>
	          </div>
	          <div class="divider-div"></div>
	          <div class="form-group">
	              <label>房屋总层数:</label>
	              <div class="col-sm-offset-1">
	                  <div class="col-sm-4">
                        @Html.DropDownListFor(p => p.BuildLevel, new List<SelectListItem>(), new { @class = "form-control" })
	                  </div>
	              </div>
	          </div>
	          <div class="divider-div"></div>

	          <div class="form-group">
	              <label>房屋结构类型:</label>
	              <div  class="col-sm-offset-1">
	                  <div class="col-sm-3">
	                      @Html.RadioButtonFor(p=>p.StructLevel,1,new { @checked= "checked"})&nbsp;&nbsp;钢结构
	                  </div>
	                  <div class="col-sm-3">
                        @Html.RadioButtonFor(p => p.StructLevel, 2)&nbsp;&nbsp;钢筋混凝土
	                  </div>
	                  <div class="col-sm-3">
	                      @Html.RadioButtonFor(p => p.StructLevel, 3)&nbsp;&nbsp;砖砌
	                  </div>
	                  <div class="col-sm-3">
	                      @Html.RadioButtonFor(p => p.StructLevel, 4)&nbsp;&nbsp;土石
	                  </div>
	              </div>
	          </div>
	          <div class="divider-div"></div>
	          <div class="form-group">
	              <label>房屋是否经过专业设计:</label>
	              <div  class="col-sm-offset-1">
	                  <div class="col-sm-3">
	                      @Html.RadioButtonFor(p => p.Designed, 1, new { @checked = "checked" })&nbsp;&nbsp;是
	                  </div>
	                  <div class="col-sm-3">
                        @Html.RadioButtonFor(p => p.Designed, 2)&nbsp;&nbsp;否
	                  </div>
	              </div>
	          </div>
	          <div class="divider-div"></div>
	          <div class="form-group">
	              <label>房屋的施工质量情况:</label>
	              <div  class="col-sm-offset-1">
	                  <div class="col-sm-3">
	                      @Html.RadioButtonFor(p => p.Jobstatus, 3, new { @checked = "checked" })&nbsp;&nbsp;好
	                  </div>
	                  <div class="col-sm-3">
	                      @Html.RadioButtonFor(p => p.Jobstatus, 2)&nbsp;&nbsp;一般
	                  </div>
	                  <div class="col-sm-3">
                        @Html.RadioButtonFor(p => p.Jobstatus, 1)&nbsp;&nbsp;差
	                  </div>
	              </div>
	          </div>
	          <div class="divider-div"></div>
	          <div class="form-group">
	              <label>房屋建造的年代:</label>
	              <div class="col-sm-offset-1">
	                  <div class="col-sm-3">
	                      @Html.RadioButtonFor(p => p.YearLevel, 1, new { @checked = "checked" })&nbsp;&nbsp;1980年前
	                  </div>
	                  <div class="col-sm-3">
	                      @Html.RadioButtonFor(p => p.YearLevel, 2)&nbsp;&nbsp;1980-1990年
	                  </div>
	                  <div class="col-sm-3">
	                      @Html.RadioButtonFor(p => p.YearLevel, 3)&nbsp;&nbsp;1990-2000年
	                  </div>
	                  <div class="col-sm-3">
	                      @Html.RadioButtonFor(p => p.YearLevel, 4)&nbsp;&nbsp;2000年后
	                  </div>
	              </div>
	          </div>
	          <div class="divider-div"></div>
	          <div class="form-group" style="margin-top: 50px;">
	              <div class="col-sm-offset-4 col-sm-4">
	                  <button type="submit" class="btn btn-lg btn-success"  id="calculate">房屋抗震能力查询</button>
	              </div>
	          </div>
	      }
	  </div>
          </div>
<script type="text/javascript">

    $(document).ready(function () {
        getAreaInformation($('#City'), $('#Provincial').val());
        $('#City').append('<option value="">---选择市县---</option>');
        $('#Region').append('<option value="">---选择区域---</option>');
		 		for(var i=1;i<=200;i++){
		 			$('#BuildLevel').append('<option value="'+i+'">'+i+'层</option>');
		 		}
		 	});

	$('#calculate').on('click',function(){
		 		if($('#Provincial').val()==='' || $('#City').val()==='' ||$('#Region').val()===''){
		 			alert('请选择您所在的地理位置');
		 			return false;
		 		}
		 		
		 		if($('#BuildLevel').val() == ''){
		 			alert('请选择您所在建筑层数');
		 			return false;
		 		}

				$('#calculate').submit();
		 	});
	$(document).ready(function(){
 
	$('#Provincial').change(function(){
	    $('#City').empty();
	    getAreaInformation($('#City'), $('#Provincial').val());
	    $('#City').append('<option value="">---选择市县---</option>');
	   
	    $('#Region').empty();
	    $('#Region').append('<option value="">---选择区域---</option>');
		
	});

	    $('#City')
	        .change(function() {
	            $('#Region').empty();
	            getAreaInformation($('#Region'), $('#City').val());
	            $('#Region').append('<option value="">---选择区域---</option>');
	            
	        });
	});
	
	function getAreaInformation(control, parentId) {

	    $.ajax({
	        url: '/quake/GetAreaParamsById?parentId='+parentId,
	        type: 'GET',
	        success: function (data) {
	            //control.append('<option value="">' + defaultString + '</option>');
	            if (data.result.success) {
	                var options = "";
	                for (var i = 0; i < data.result.areas.length; i++){	               
	                    var area = data.result.areas[i];
	                        options = options + "<option value='" + area.Id + "'>"+ area.Name + '</option>';
	                }
	                control.append(options);
	            }
	        }
	    });

	}
	
	</script>